---
import Layout from '../../layouts/Layout.astro';
import BlogCard from '../../components/BlogCard.astro';
import { getCollection } from 'astro:content';

const base = Astro.site.pathname.endsWith('/') ? Astro.site.pathname : Astro.site.pathname + '/';
const posts = await getCollection('blog');
const sortedPosts = posts.sort((a, b) => new Date(b.data.pubDate) - new Date(a.data.pubDate));
---

<Layout title="Freelance Automator Blog" description="Latest automation tips, tools, and insights for freelancers.">
  <section style="padding: 2rem 0;">
    <h1>Blog</h1>
    <p>Explore the latest strategies, tools, and tutorials to help you automate and scale your freelance business.</p>
  </section>

  <section style="display: grid; gap: 1.5rem; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
    {sortedPosts.map(post => (
      <BlogCard
        title={post.data.title}
        description={post.data.description}
        date={new Date(post.data.pubDate).toLocaleDateString()}
        link={`blog/${post.slug}/`}
      />
    ))}
  </section>
</Layout>
